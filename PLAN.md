# План реализации программы ChatList

## Этап 1: Подготовка проекта и структуры

### 1.1 Инициализация проекта
- [x] Создать базовую структуру PyQt приложения
- [ ] Создать структуру папок проекта
- [ ] Настроить requirements.txt с необходимыми зависимостями
- [ ] Создать .env.example файл для примера конфигурации

### 1.2 Создание модульной структуры
- [ ] Создать модуль `db.py` для работы с SQLite
- [ ] Создать модуль `models.py` для логики работы с моделями
- [ ] Создать модуль `network.py` для HTTP-запросов к API
- [ ] Создать модуль `config.py` для загрузки настроек из .env

## Этап 2: Реализация базы данных

### 2.1 Создание схемы БД
- [ ] Реализовать функцию создания таблиц в `db.py`:
  - Таблица `prompts` (id, date, prompt, tags)
  - Таблица `models` (id, name, api_url, api_id, is_active)
  - Таблица `results` (id, prompt_id, model_id, response, selected, created_at)
  - Таблица `settings` (key, value)

### 2.2 CRUD операции для таблиц
- [ ] Реализовать функции для работы с `prompts`:
  - `create_prompt(date, prompt, tags)`
  - `get_all_prompts()`
  - `get_prompt_by_id(id)`
  - `search_prompts(query)`
  - `delete_prompt(id)`

- [ ] Реализовать функции для работы с `models`:
  - `create_model(name, api_url, api_id, is_active)`
  - `get_active_models()`
  - `get_all_models()`
  - `update_model_status(id, is_active)`
  - `delete_model(id)`

- [ ] Реализовать функции для работы с `results`:
  - `save_results(results_list)`
  - `get_all_results()`
  - `get_results_by_prompt(prompt_id)`
  - `search_results(query)`
  - `delete_result(id)`

- [ ] Реализовать функции для работы с `settings`:
  - `get_setting(key)`
  - `set_setting(key, value)`

## Этап 3: Реализация работы с API

### 3.1 Модуль network.py
- [ ] Создать базовый класс для работы с API
- [ ] Реализовать загрузку API-ключей из .env файла
- [ ] Реализовать функцию отправки запроса к OpenAI API
- [ ] Реализовать функцию отправки запроса к DeepSeek API
- [ ] Реализовать функцию отправки запроса к Groq API
- [ ] Создать универсальную функцию `send_request(model, prompt)` с обработкой разных типов API
- [ ] Добавить обработку ошибок и таймаутов
- [ ] Реализовать асинхронную отправку запросов к нескольким моделям

### 3.2 Модуль models.py
- [ ] Реализовать класс Model для представления нейросети
- [ ] Реализовать функцию `get_active_models()` для получения списка активных моделей
- [ ] Реализовать функцию `send_prompt_to_models(prompt, models)` для параллельной отправки

## Этап 4: Реализация графического интерфейса

### 4.1 Основное окно (main.py)
- [ ] Создать главное окно приложения
- [ ] Реализовать меню и панель инструментов
- [ ] Разделить окно на области:
  - Левая панель: список сохраненных промтов
  - Центральная область: поле ввода промта
  - Правая панель: настройки моделей
  - Нижняя область: таблица результатов

### 4.2 Область ввода промта
- [ ] Создать текстовое поле для ввода нового промта
- [ ] Добавить кнопку "Отправить"
- [ ] Добавить выпадающий список для выбора сохраненного промта
- [ ] Добавить поле для ввода тегов
- [ ] Реализовать кнопку "Сохранить промт"

### 4.3 Таблица результатов
- [ ] Создать QTableWidget для отображения результатов
- [ ] Настроить колонки: Модель, Ответ, Выбрано (чекбокс)
- [ ] Реализовать временное хранение результатов в памяти
- [ ] Добавить кнопку "Сохранить выбранные"
- [ ] Реализовать очистку таблицы при новом запросе
- [ ] Добавить поиск и сортировку по колонкам

### 4.4 Панель управления моделями
- [ ] Создать список моделей с чекбоксами (активна/неактивна)
- [ ] Добавить кнопку "Добавить модель"
- [ ] Добавить кнопку "Редактировать модель"
- [ ] Добавить кнопку "Удалить модель"
- [ ] Реализовать диалог добавления/редактирования модели

### 4.5 Панель истории промтов
- [ ] Создать список сохраненных промтов
- [ ] Добавить поиск по промтам
- [ ] Добавить фильтрацию по тегам
- [ ] Реализовать двойной клик для выбора промта
- [ ] Добавить контекстное меню (удалить, редактировать)

## Этап 5: Интеграция компонентов

### 5.1 Связывание UI с базой данных
- [ ] Подключить загрузку промтов из БД в список
- [ ] Подключить сохранение промтов в БД
- [ ] Подключить загрузку моделей из БД
- [ ] Подключить сохранение результатов в БД

### 5.2 Связывание UI с API
- [ ] Реализовать обработчик кнопки "Отправить"
- [ ] Интегрировать отправку запросов к моделям
- [ ] Реализовать отображение результатов в таблице
- [ ] Добавить индикатор загрузки во время запросов
- [ ] Обработать ошибки при запросах к API

### 5.3 Сохранение результатов
- [ ] Реализовать обработчик кнопки "Сохранить выбранные"
- [ ] Сохранить выбранные результаты в таблицу results
- [ ] Очистить временную таблицу после сохранения

## Этап 6: Дополнительные функции

### 6.1 Поиск и сортировка
- [ ] Реализовать поиск в таблице промтов
- [ ] Реализовать поиск в таблице результатов
- [ ] Добавить сортировку по колонкам во всех таблицах

### 6.2 Экспорт данных
- [ ] Реализовать экспорт результатов в Markdown
- [ ] Реализовать экспорт результатов в JSON
- [ ] Добавить меню "Экспорт" с выбором формата

### 6.3 Логирование
- [ ] Добавить модуль логирования
- [ ] Логировать все запросы к API
- [ ] Логировать ошибки и исключения
- [ ] Добавить просмотр логов в интерфейсе

### 6.4 Настройки приложения
- [ ] Реализовать окно настроек
- [ ] Добавить настройку таймаутов запросов
- [ ] Добавить настройку путей к файлам
- [ ] Сохранять настройки в таблицу settings

## Этап 7: Тестирование и оптимизация

### 7.1 Тестирование функциональности
- [ ] Протестировать работу с базой данных
- [ ] Протестировать отправку запросов к API
- [ ] Протестировать сохранение и загрузку данных
- [ ] Протестировать UI компоненты

### 7.2 Обработка ошибок
- [ ] Добавить обработку ошибок подключения к БД
- [ ] Добавить обработку ошибок API запросов
- [ ] Добавить валидацию ввода данных
- [ ] Улучшить сообщения об ошибках для пользователя

### 7.3 Оптимизация
- [ ] Оптимизировать запросы к базе данных
- [ ] Оптимизировать загрузку данных в UI
- [ ] Добавить кэширование при необходимости

## Этап 8: Финальная доработка

### 8.1 Документация
- [ ] Написать README с инструкциями по установке
- [ ] Добавить комментарии в код
- [ ] Создать примеры использования

### 8.2 Сборка
- [ ] Обновить build.bat для финальной сборки
- [ ] Протестировать исполняемый файл
- [ ] Подготовить релиз

